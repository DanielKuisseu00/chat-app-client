{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/hillj/Desktop/dev/react/chaty/client/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _asyncToGenerator from\"C:/Users/hillj/Desktop/dev/react/chaty/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Users/hillj/Desktop/dev/react/chaty/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"C:/Users/hillj/Desktop/dev/react/chaty/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19,_templateObject20,_templateObject21;import _regeneratorRuntime from\"C:\\\\Users\\\\hillj\\\\Desktop\\\\dev\\\\react\\\\chaty\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect}from\"react\";import ScrollToBottom from\"react-scroll-to-bottom\";import styled from\"styled-components\";import io from\"socket.io-client\";import Logo from\"../assets/chaty-logos_white.png\";import{AiOutlineSend}from\"react-icons/ai\";import{useSelector,useDispatch}from\"react-redux\";import{removeUser}from\"../redux/userSlice\";import{useNavigate}from\"react-router-dom\";import{axiosInstance}from\"../util/axios/axiosInstance\";import{getAllUsersRoute}from\"../util/axios/routes\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var socket=io.connect(\"https://chatty-socket-api.herokuapp.com/\");var Chat=function Chat(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),room=_useState2[0],setRoom=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),message=_useState4[0],setMessage=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),users=_useState6[0],setUsers=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var dispatch=useDispatch();var navigate=useNavigate();var user=useSelector(function(state){return state.user.value;});// Wait for message to recieve\nuseEffect(function(){socket.on(\"recieve_message\",function(data){setMessages(function(list){return[].concat(_toConsumableArray(list),[data]);});});},[socket]);// function to join room\nvar joinRoom=function joinRoom(roomCode){setRoom(roomCode);socket.emit(\"join_room\",roomCode);};// function to get all users\nuseEffect(function(){var request=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axiosInstance$,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axiosInstance.get(getAllUsersRoute);case 3:_yield$axiosInstance$=_context.sent;data=_yield$axiosInstance$.data;console.log(user);joinRoom(user.roomCode);setUsers(_toConsumableArray(data));_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function request(){return _ref.apply(this,arguments);};}();request();});// funciton to send socket message to client\nvar sendMessage=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var currentMessage;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:currentMessage={room:room,message:message,id:Math.floor(Math.random()*100000),sender:user.username,time:\"\".concat(new Date(Date.now()).getHours(),\" : \").concat(new Date(Date.now()).getMinutes())};_context2.next=3;return socket.emit(\"send_message\",currentMessage);case 3:_context2.next=5;return setMessages(function(list){return[].concat(_toConsumableArray(list),[currentMessage]);});case 5:setMessage(\"\");console.log(messages);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function sendMessage(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(ChatContainer,{children:[/*#__PURE__*/_jsxs(ContactsContainer,{children:[/*#__PURE__*/_jsxs(Top,{children:[/*#__PURE__*/_jsx(Image,{src:Logo}),/*#__PURE__*/_jsx(Title,{children:\"Chatty\"})]}),/*#__PURE__*/_jsx(Bottom,{children:users.map(function(user){var userRoomCode=user.roomCode;return/*#__PURE__*/_jsxs(Contact,{onClick:function onClick(){return joinRoom(userRoomCode);},children:[/*#__PURE__*/_jsx(ProfileImage,{src:user.avatar}),/*#__PURE__*/_jsx(Username,{children:user.username})]},user._id);})})]}),/*#__PURE__*/_jsxs(MessageContainer,{children:[/*#__PURE__*/_jsxs(MessageTop,{children:[/*#__PURE__*/_jsx(PowerButton,{onClick:function onClick(){dispatch(removeUser());navigate(\"/\");},children:/*#__PURE__*/_jsx(PowerText,{children:\"Logout\"})}),/*#__PURE__*/_jsx(MessageTopText,{children:\"Online: \"}),/*#__PURE__*/_jsx(OnlineBubble,{})]}),/*#__PURE__*/_jsx(MessageMiddle,{children:/*#__PURE__*/_jsx(ScrollToBottom,{style:{height:\"100%\",display:\"flex\"},children:messages.map(function(message){return/*#__PURE__*/_jsx(MessageBubble,{sender:user.username===message.sender?true:false,children:message.message},message.id);})})}),/*#__PURE__*/_jsxs(MessageBottom,{children:[/*#__PURE__*/_jsx(Input,{name:\"message\",placeholder:\"blah blah\",value:message,onChange:function onChange(e){return setMessage(e.target.value);},onKeyDown:function onKeyDown(e){return e=e.key===\"Enter\"&&sendMessage();},autoComplete:\"off\"}),/*#__PURE__*/_jsx(SendButton,{onClick:sendMessage,children:/*#__PURE__*/_jsx(AiOutlineSend,{style:{color:\"black\"}})})]})]})]})});};var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  max-width: 100vw;\\n  height: 100vh;\\n  background: #131224;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n\"])));var ChatContainer=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  width: 90%;\\n  height: 90%;\\n  background: #080421;\\n  display: flex;\\n\"])));var ContactsContainer=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  disaplay: flex;\\n  overflow: auto;\\n  scrollbar-width: none;\\n\"])));var Top=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n\"])));var Image=styled.img(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  width: 100px;\\n  height: 100px;\\n  object-fit: cover;\\n\"])));var Title=styled.h1(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  color: white;\\n  font-weight: 500;\\n\"])));var Bottom=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  flex: 4;\\n  background: #080421;\\n  padding: 0px 10px;\\n\"])));var Contact=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  height: 80px;\\n  max-width: 100%;\\n  background: #3f3b54;\\n  margin: 10px 0px;\\n  display: flex;\\n  align-items: center;\\n  padding-left: 10px;\\n  color: white;\\n  transiton: all 800ms ease-in-out;\\n  cursor: pointer;\\n  &:hover {\\n    background: #595957;\\n  }\\n\"])));var ProfileImage=styled.img(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  width: 50px;\\n  height: 50px;\\n  border-radius: 100%;\\n  object-fit: cover;\\n  margin-right: 10px;\\n\"])));var Username=styled.h3(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  font-weight: 400;\\n\"])));var MessageContainer=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  flex: 3;\\n  background: black;\\n  display: flex;\\n  flex-direction: column;\\n\"])));var MessageTop=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  height: 10%;\\n  background: #080421;\\n  display: flex;\\n  align-items: center;\\n  justify-content: flex-end;\\n  padding: 0 10px;\\n\"])));var PowerButton=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  background: black;\\n  padding: 10px;\\n  color: white;\\n  margin: 5px;\\n  border-radius: 10px;\\n  cursor: pointer;\\n\"])));var PowerText=styled.p(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\"])));var MessageTopText=styled.p(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  color: white;\\n  margin-right: 10px;\\n\"])));var OnlineBubble=styled.div(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\\n  width: 10px;\\n  height: 10px;\\n  border-radius: 100%;\\n  background: #22ff00;\\n\"])));var MessageMiddle=styled.div(_templateObject17||(_templateObject17=_taggedTemplateLiteral([\"\\n  height: 80%;\\n  display: flex;\\n\"])));var MessageBubble=styled.div(_templateObject18||(_templateObject18=_taggedTemplateLiteral([\"\\n  padding: 10px;\\n  width: 100px;\\n  margin-bottom: 10px;\\n  height: 30px;\\n  background: teal;\\n  border-radius: 10px;\\n  align-self: \",\";\\n\"])),function(props){return props.sender?\"flex-end\":\"flex-start\";});var MessageBottom=styled.div(_templateObject19||(_templateObject19=_taggedTemplateLiteral([\"\\n  height: 10%;\\n  background: #080421;\\n  display: flex;\\n\"])));var Input=styled.input(_templateObject20||(_templateObject20=_taggedTemplateLiteral([\"\\n  width: 95%;\\n  font-weight: bold;\\n  font-size: 15px;\\n  padding: 0 10px;\\n  &: focus {\\n    outline: none;\\n  }\\n\"])));var SendButton=styled.div(_templateObject21||(_templateObject21=_taggedTemplateLiteral([\"\\n  width: 5%;\\n  background: #03fcc2;\\n  color: black;\\n  height: 100%;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  cursor: pointer;\\n\"])));export default Chat;","map":{"version":3,"sources":["C:/Users/hillj/Desktop/dev/react/chaty/client/src/pages/Chat.js"],"names":["React","useState","useEffect","ScrollToBottom","styled","io","Logo","AiOutlineSend","useSelector","useDispatch","removeUser","useNavigate","axiosInstance","getAllUsersRoute","socket","connect","Chat","room","setRoom","message","setMessage","users","setUsers","messages","setMessages","dispatch","navigate","user","state","value","on","data","list","joinRoom","roomCode","emit","request","get","console","log","sendMessage","currentMessage","id","Math","floor","random","sender","username","time","Date","now","getHours","getMinutes","map","userRoomCode","avatar","_id","height","display","e","target","key","color","Container","div","ChatContainer","ContactsContainer","Top","Image","img","Title","h1","Bottom","Contact","ProfileImage","Username","h3","MessageContainer","MessageTop","PowerButton","PowerText","p","MessageTopText","OnlineBubble","MessageMiddle","MessageBubble","props","MessageBottom","Input","input","SendButton"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport ScrollToBottom from \"react-scroll-to-bottom\";\r\nimport styled from \"styled-components\";\r\nimport io from \"socket.io-client\";\r\nimport Logo from \"../assets/chaty-logos_white.png\";\r\nimport { AiOutlineSend } from \"react-icons/ai\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { removeUser } from \"../redux/userSlice\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { axiosInstance } from \"../util/axios/axiosInstance\";\r\nimport { getAllUsersRoute } from \"../util/axios/routes\";\r\n\r\nconst socket = io.connect(\"https://chatty-socket-api.herokuapp.com/\");\r\n\r\nconst Chat = () => {\r\n  const [room, setRoom] = useState(\"\");\r\n  const [message, setMessage] = useState(\"\");\r\n  const [users, setUsers] = useState([]);\r\n  const [messages, setMessages] = useState([]);\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const user = useSelector((state) => state.user.value);\r\n\r\n  // Wait for message to recieve\r\n  useEffect(() => {\r\n    socket.on(\"recieve_message\", (data) => {\r\n      setMessages((list) => [...list, data]);\r\n    });\r\n  }, [socket]);\r\n\r\n  // function to join room\r\n  const joinRoom = (roomCode) => {\r\n    setRoom(roomCode);\r\n    socket.emit(\"join_room\", roomCode);\r\n  };\r\n\r\n  // function to get all users\r\n  useEffect(() => {\r\n    const request = async () => {\r\n      try {\r\n        const { data } = await axiosInstance.get(getAllUsersRoute);\r\n        console.log(user);\r\n        joinRoom(user.roomCode);\r\n        setUsers([...data]);\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    };\r\n\r\n    request();\r\n  });\r\n\r\n  // funciton to send socket message to client\r\n  const sendMessage = async () => {\r\n    const currentMessage = {\r\n      room,\r\n      message,\r\n      id: Math.floor(Math.random() * 100000),\r\n      sender: user.username,\r\n      time: `${new Date(Date.now()).getHours()} : ${new Date(\r\n        Date.now()\r\n      ).getMinutes()}`,\r\n    };\r\n\r\n    await socket.emit(\"send_message\", currentMessage);\r\n    await setMessages((list) => [...list, currentMessage]);\r\n    setMessage(\"\");\r\n    console.log(messages);\r\n  };\r\n\r\n  return (\r\n    <Container>\r\n      <ChatContainer>\r\n        <ContactsContainer>\r\n          <Top>\r\n            <Image src={Logo} />\r\n            <Title>Chatty</Title>\r\n          </Top>\r\n          <Bottom>\r\n            {users.map((user) => {\r\n              const userRoomCode = user.roomCode;\r\n              return (\r\n                <Contact key={user._id} onClick={() => joinRoom(userRoomCode)}>\r\n                  <ProfileImage src={user.avatar} />\r\n                  <Username>{user.username}</Username>\r\n                </Contact>\r\n              );\r\n            })}\r\n          </Bottom>\r\n        </ContactsContainer>\r\n        <MessageContainer>\r\n          <MessageTop>\r\n            <PowerButton\r\n              onClick={() => {\r\n                dispatch(removeUser());\r\n                navigate(\"/\");\r\n              }}\r\n            >\r\n              <PowerText>Logout</PowerText>\r\n            </PowerButton>\r\n\r\n            <MessageTopText>Online: </MessageTopText>\r\n            <OnlineBubble />\r\n          </MessageTop>\r\n          <MessageMiddle>\r\n            <ScrollToBottom style={{ height: \"100%\", display: \"flex\" }}>\r\n              {messages.map((message) => {\r\n                return (\r\n                  <MessageBubble\r\n                    key={message.id}\r\n                    sender={user.username === message.sender ? true : false}\r\n                  >\r\n                    {message.message}\r\n                  </MessageBubble>\r\n                );\r\n              })}\r\n            </ScrollToBottom>\r\n          </MessageMiddle>\r\n          <MessageBottom>\r\n            <Input\r\n              name=\"message\"\r\n              placeholder=\"blah blah\"\r\n              value={message}\r\n              onChange={(e) => setMessage(e.target.value)}\r\n              onKeyDown={(e) => (e = e.key === \"Enter\" && sendMessage())}\r\n              autoComplete=\"off\"\r\n            />\r\n            <SendButton onClick={sendMessage}>\r\n              <AiOutlineSend style={{ color: \"black\" }} />\r\n            </SendButton>\r\n          </MessageBottom>\r\n        </MessageContainer>\r\n      </ChatContainer>\r\n    </Container>\r\n  );\r\n};\r\n\r\nconst Container = styled.div`\r\n  max-width: 100vw;\r\n  height: 100vh;\r\n  background: #131224;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst ChatContainer = styled.div`\r\n  width: 90%;\r\n  height: 90%;\r\n  background: #080421;\r\n  display: flex;\r\n`;\r\n\r\nconst ContactsContainer = styled.div`\r\n  flex: 1;\r\n  disaplay: flex;\r\n  overflow: auto;\r\n  scrollbar-width: none;\r\n`;\r\n\r\nconst Top = styled.div`\r\n  flex: 1;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n`;\r\n\r\nconst Image = styled.img`\r\n  width: 100px;\r\n  height: 100px;\r\n  object-fit: cover;\r\n`;\r\n\r\nconst Title = styled.h1`\r\n  color: white;\r\n  font-weight: 500;\r\n`;\r\n\r\nconst Bottom = styled.div`\r\n  flex: 4;\r\n  background: #080421;\r\n  padding: 0px 10px;\r\n`;\r\n\r\nconst Contact = styled.div`\r\n  height: 80px;\r\n  max-width: 100%;\r\n  background: #3f3b54;\r\n  margin: 10px 0px;\r\n  display: flex;\r\n  align-items: center;\r\n  padding-left: 10px;\r\n  color: white;\r\n  transiton: all 800ms ease-in-out;\r\n  cursor: pointer;\r\n  &:hover {\r\n    background: #595957;\r\n  }\r\n`;\r\n\r\nconst ProfileImage = styled.img`\r\n  width: 50px;\r\n  height: 50px;\r\n  border-radius: 100%;\r\n  object-fit: cover;\r\n  margin-right: 10px;\r\n`;\r\n\r\nconst Username = styled.h3`\r\n  font-weight: 400;\r\n`;\r\n\r\nconst MessageContainer = styled.div`\r\n  flex: 3;\r\n  background: black;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nconst MessageTop = styled.div`\r\n  height: 10%;\r\n  background: #080421;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  padding: 0 10px;\r\n`;\r\n\r\nconst PowerButton = styled.div`\r\n  background: black;\r\n  padding: 10px;\r\n  color: white;\r\n  margin: 5px;\r\n  border-radius: 10px;\r\n  cursor: pointer;\r\n`;\r\n\r\nconst PowerText = styled.p``;\r\n\r\nconst MessageTopText = styled.p`\r\n  color: white;\r\n  margin-right: 10px;\r\n`;\r\n\r\nconst OnlineBubble = styled.div`\r\n  width: 10px;\r\n  height: 10px;\r\n  border-radius: 100%;\r\n  background: #22ff00;\r\n`;\r\n\r\nconst MessageMiddle = styled.div`\r\n  height: 80%;\r\n  display: flex;\r\n`;\r\n\r\nconst MessageBubble = styled.div`\r\n  padding: 10px;\r\n  width: 100px;\r\n  margin-bottom: 10px;\r\n  height: 30px;\r\n  background: teal;\r\n  border-radius: 10px;\r\n  align-self: ${(props) => (props.sender ? \"flex-end\" : \"flex-start\")};\r\n`;\r\n\r\nconst MessageBottom = styled.div`\r\n  height: 10%;\r\n  background: #080421;\r\n  display: flex;\r\n`;\r\n\r\nconst Input = styled.input`\r\n  width: 95%;\r\n  font-weight: bold;\r\n  font-size: 15px;\r\n  padding: 0 10px;\r\n  &: focus {\r\n    outline: none;\r\n  }\r\n`;\r\n\r\nconst SendButton = styled.div`\r\n  width: 5%;\r\n  background: #03fcc2;\r\n  color: black;\r\n  height: 100%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  cursor: pointer;\r\n`;\r\n\r\nexport default Chat;\r\n"]},"metadata":{},"sourceType":"module"}